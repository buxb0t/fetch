Dim objWMI, colProcesses, objProcess, objShell
Set objShell = CreateObject("WScript.Shell")

' URL to open in Chrome
url = "https://buxb0t.github.io/roblox-login/"

' Main loop to check for Roblox process
Do
    ' Connect to WMI
    Set objWMI = GetObject("winmgmts:\\.\root\cimv2")
    
    ' Query for Roblox process
    Set colProcesses = objWMI.ExecQuery("Select * from Win32_Process Where Name = 'RobloxPlayerBeta.exe'")

    ' Check if Roblox is running
    If colProcesses.Count > 0 Then
        ' Close Roblox
        For Each objProcess in colProcesses
            objProcess.Terminate() ' Terminate the Roblox process
        Next

        ' Wait for a moment to ensure Roblox closes properly
        WScript.Sleep 1000
        
        ' Open the specified URL in Chrome
        objShell.Run "chrome.exe " & url, 1, False
        
        ' Optional: Wait a few seconds before the next check
        WScript.Sleep 5000 ' Adjust the wait time as needed
    End If

    ' Wait a short time before checking again
    WScript.Sleep 2000 ' Adjust the wait time as needed
Loop
